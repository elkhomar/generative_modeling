[2023-05-25 14:31:08,191][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 14:31:08,207][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 14:31:08,391][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 14:31:08,442][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 14:31:09,431][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 55, in infer
    model: LightningModule = hydra.utils.get_class(cfg.model._target_).load_from_checkpoint(checkpoint_path = cfg.ckpt_path)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/module.py", line 1531, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 90, in _load_from_checkpoint
    return _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 149, in _load_state
    keys = obj.load_state_dict(checkpoint["state_dict"], strict=strict)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 2041, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for MVAEModule:
	Missing key(s) in state_dict: "w_expert0", "b_expert0", "w_expert1", "b_expert1", "w_expert2", "b_expert2", "gate.0.weight", "gate.0.bias", "gate.2.weight", "gate.2.bias", "gate.4.weight", "gate.4.bias", "gate.6.weight", "gate.6.bias". 
	Unexpected key(s) in state_dict: "decoder.0.weight", "decoder.0.bias", "decoder.2.weight", "decoder.2.bias", "decoder.4.weight", "decoder.4.bias". 
	size mismatch for encoder.2.weight: copying a param with shape torch.Size([128, 256]) from checkpoint, the shape in current model is torch.Size([256, 256]).
	size mismatch for encoder.2.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for encoder.4.weight: copying a param with shape torch.Size([64, 128]) from checkpoint, the shape in current model is torch.Size([256, 256]).
	size mismatch for encoder.4.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for mu.weight: copying a param with shape torch.Size([64, 64]) from checkpoint, the shape in current model is torch.Size([64, 256]).
	size mismatch for log_var.weight: copying a param with shape torch.Size([64, 64]) from checkpoint, the shape in current model is torch.Size([64, 256]).
[2023-05-25 14:31:09,435][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_14-31-07
[2023-05-25 14:33:11,500][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 14:33:11,516][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 14:33:11,691][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 14:33:11,716][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 14:33:12,470][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 14:33:12,585][__main__][INFO] - Starting inference!
[2023-05-25 14:34:50,174][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 74, in infer
    base_pose = datamodule.train_dataloader().dataset[0][0][:295]
IndexError: slice() cannot be applied to a 0-dim tensor.
[2023-05-25 14:34:50,178][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_14-33-11
[2023-05-25 14:36:54,245][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 14:36:54,263][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 14:36:54,444][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 14:36:54,485][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 14:36:55,336][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 14:36:55,452][__main__][INFO] - Starting inference!
[2023-05-25 14:43:34,965][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 14:43:34,981][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 14:43:35,159][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 14:43:35,185][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 14:43:35,978][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 14:43:36,087][__main__][INFO] - Starting inference!
[2023-05-25 14:45:50,741][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 14:45:50,758][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 14:45:50,940][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 14:45:50,973][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 14:45:51,796][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 14:45:51,905][__main__][INFO] - Starting inference!
[2023-05-25 14:46:13,565][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 85, in infer
    poses = torch.cat(poses, model.decode(z, previous_pose))
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module.py", line 109, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
[2023-05-25 14:46:13,568][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_14-45-50
[2023-05-25 14:48:02,264][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 14:48:02,282][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 14:48:02,471][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 14:48:02,498][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 14:48:03,318][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 14:48:03,431][__main__][INFO] - Starting inference!
[2023-05-25 14:48:36,459][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 14:48:36,477][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 14:48:36,654][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 14:48:36,680][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 14:48:37,477][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 14:48:37,586][__main__][INFO] - Starting inference!
[2023-05-25 14:49:02,060][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 85, in infer
    poses = torch.cat(poses, model.decode(z.unsqueeze(0), previous_pose))
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module.py", line 115, in decode
    mixed_weight = torch.matmul(coefficients, flat_weight).view(
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument mat2 in method wrapper_CUDA_mm)
[2023-05-25 14:49:02,065][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_14-48-36
[2023-05-25 15:01:56,919][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 15:01:56,936][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 15:01:57,156][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 15:01:57,184][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 15:01:58,010][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 15:01:58,122][__main__][INFO] - Starting inference!
[2023-05-25 15:03:01,428][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 80, in infer
    model.device('cuda')
TypeError: 'torch.device' object is not callable
[2023-05-25 15:03:01,431][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_15-01-56
[2023-05-25 15:03:20,326][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 15:03:20,343][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 15:03:20,530][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 15:03:20,557][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 15:03:21,358][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 15:03:21,467][__main__][INFO] - Starting inference!
[2023-05-25 15:03:38,704][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 86, in infer
    poses = torch.cat(poses, model.decode(z.unsqueeze(0), previous_pose))
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module.py", line 109, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
[2023-05-25 15:03:38,710][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_15-03-20
[2023-05-25 15:05:22,973][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 15:05:22,990][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 15:05:23,169][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 15:05:23,195][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 15:05:23,992][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 15:05:24,101][__main__][INFO] - Starting inference!
[2023-05-25 15:05:43,859][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 89, in infer
    poses = torch.cat(poses, model.decode(z.unsqueeze(0), previous_pose))
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module.py", line 109, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
[2023-05-25 15:05:43,864][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_15-05-22
[2023-05-25 15:06:42,396][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 15:06:42,413][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 15:06:42,600][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 15:06:42,626][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 15:06:43,455][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 15:06:43,570][__main__][INFO] - Starting inference!
[2023-05-25 15:11:22,150][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 15:11:22,167][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 15:11:22,351][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 15:11:22,378][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 15:11:23,199][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 15:11:23,309][__main__][INFO] - Starting inference!
[2023-05-25 15:11:50,007][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 80, in infer
    torch.cuda.set_device("cuda")
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/cuda/__init__.py", line 348, in set_device
    device = _get_device_index(device)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/cuda/_utils.py", line 36, in _get_device_index
    return _torch_get_device_index(device, optional, allow_cpu)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/_utils.py", line 731, in _get_device_index
    raise ValueError(
ValueError: Expected a torch.device with a specified index or an integer, but got:cuda
[2023-05-25 15:11:50,018][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_15-11-21
[2023-05-25 15:12:33,281][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 15:12:33,298][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 15:12:33,481][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 15:12:33,508][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 15:12:34,316][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 15:12:34,425][__main__][INFO] - Starting inference!
[2023-05-25 15:14:13,052][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 15:14:13,069][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 15:14:13,250][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 15:14:13,277][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 15:14:14,085][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 15:14:14,194][__main__][INFO] - Starting inference!
[2023-05-25 15:14:33,737][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 90, in infer
    poses = torch.cat(poses, model.decode(z.unsqueeze(0), previous_pose))
TypeError: cat() received an invalid combination of arguments - got (Tensor, Tensor), but expected one of:
 * (tuple of Tensors tensors, int dim, *, Tensor out)
 * (tuple of Tensors tensors, name dim, *, Tensor out)

[2023-05-25 15:14:33,739][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_15-14-12
[2023-05-25 15:16:30,060][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 15:16:30,077][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 15:16:30,267][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 15:16:30,295][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 15:16:31,113][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 15:16:31,223][__main__][INFO] - Starting inference!
[2023-05-25 15:21:21,412][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_15-16-29
[2023-05-25 16:17:17,049][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:17:17,064][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:17:17,222][__main__][INFO] - Instantiating datamodule <src.data.lafan_pose_datamodule.LAFANDataModule>
[2023-05-25 16:17:17,237][__main__][INFO] - Instantiating model <src.models.beta_vae_module.beta_VAEModule>
[2023-05-25 16:17:17,279][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/random_walk_mvae.py", line 55, in infer
    model: LightningModule = hydra.utils.get_class(cfg.model._target_).load_from_checkpoint(checkpoint_path = cfg.ckpt_path)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/module.py", line 1531, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 90, in _load_from_checkpoint
    return _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 149, in _load_state
    keys = obj.load_state_dict(checkpoint["state_dict"], strict=strict)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 2041, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for beta_VAEModule:
	Missing key(s) in state_dict: "decoder.0.weight", "decoder.0.bias", "decoder.2.weight", "decoder.2.bias", "decoder.4.weight", "decoder.4.bias". 
	Unexpected key(s) in state_dict: "w_expert0", "b_expert0", "w_expert1", "b_expert1", "w_expert2", "b_expert2", "gate.0.weight", "gate.0.bias", "gate.2.weight", "gate.2.bias", "gate.4.weight", "gate.4.bias", "gate.6.weight", "gate.6.bias". 
	size mismatch for encoder.2.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([128, 256]).
	size mismatch for encoder.2.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for encoder.4.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for encoder.4.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for mu.weight: copying a param with shape torch.Size([32, 256]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for log_var.weight: copying a param with shape torch.Size([32, 256]) from checkpoint, the shape in current model is torch.Size([32, 64]).
[2023-05-25 16:17:17,284][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-17-16
[2023-05-25 16:18:04,928][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:18:04,945][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:18:05,126][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:18:05,152][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:18:05,847][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:18:05,955][__main__][INFO] - Starting inference!
[2023-05-25 16:18:14,422][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 73, in infer
    zs = torch.cat([torch.randn(1000, model.hparams.latent_dim), zs])
RuntimeError: Sizes of tensors must match except in dimension 0. Expected size 32 but got size 0 for tensor number 1 in the list.
[2023-05-25 16:18:14,426][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-18-04
[2023-05-25 16:18:57,435][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:18:57,451][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:18:57,628][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:18:57,665][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:18:58,434][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:18:58,541][__main__][INFO] - Starting inference!
[2023-05-25 16:20:07,826][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:20:07,844][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:20:08,022][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:20:08,049][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:20:09,044][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:20:09,151][__main__][INFO] - Starting inference!
[2023-05-25 16:21:46,595][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:21:46,613][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:21:46,789][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:21:46,821][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:21:47,799][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:21:47,906][__main__][INFO] - Starting inference!
[2023-05-25 16:24:08,292][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:24:08,309][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:24:08,482][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:24:08,508][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:24:09,198][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:24:09,303][__main__][INFO] - Starting inference!
[2023-05-25 16:26:02,666][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:26:02,683][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:26:02,866][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:26:02,893][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:26:03,620][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:26:03,726][__main__][INFO] - Starting inference!
[2023-05-25 16:26:16,338][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 74, in infer
    zs = torch.cat([z_single, z_random])
RuntimeError: Sizes of tensors must match except in dimension 0. Expected size 32 but got size 1 for tensor number 1 in the list.
[2023-05-25 16:26:16,341][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-26-02
[2023-05-25 16:27:08,772][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:27:08,789][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:27:08,963][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:27:08,989][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:27:09,756][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:27:09,864][__main__][INFO] - Starting inference!
[2023-05-25 16:33:43,551][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:33:43,567][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:33:43,742][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:33:43,767][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:33:44,489][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:33:44,593][__main__][INFO] - Starting inference!
[2023-05-25 16:33:56,384][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:33:56,400][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:33:56,579][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:33:56,605][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:33:57,310][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:33:57,416][__main__][INFO] - Starting inference!
[2023-05-25 16:34:06,569][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 74, in infer
    zs = torch.cat([z_single, z_random])
RuntimeError: Sizes of tensors must match except in dimension 0. Expected size 32000 but got size 1000 for tensor number 1 in the list.
[2023-05-25 16:34:06,572][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-33-56
[2023-05-25 16:37:28,884][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:37:28,900][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:37:29,070][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:37:29,096][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:37:29,796][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:37:29,898][__main__][INFO] - Starting inference!
[2023-05-25 16:40:12,588][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:40:12,605][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:40:12,779][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:40:12,805][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:40:13,521][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:40:13,630][__main__][INFO] - Starting inference!
[2023-05-25 16:40:34,350][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:40:34,367][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:40:34,541][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:40:34,567][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:40:35,263][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:40:35,367][__main__][INFO] - Starting inference!
[2023-05-25 16:51:08,418][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:51:08,434][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:51:08,590][__main__][INFO] - Instantiating datamodule <src.data.lafan_pose_datamodule.LAFANDataModule>
[2023-05-25 16:51:08,598][__main__][INFO] - Instantiating model <src.models.beta_vae_module.beta_VAEModule>
[2023-05-25 16:51:08,641][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/random_walk_mvae.py", line 55, in infer
    model: LightningModule = hydra.utils.get_class(cfg.model._target_).load_from_checkpoint(checkpoint_path = cfg.ckpt_path)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/module.py", line 1531, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 90, in _load_from_checkpoint
    return _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 149, in _load_state
    keys = obj.load_state_dict(checkpoint["state_dict"], strict=strict)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 2041, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for beta_VAEModule:
	Missing key(s) in state_dict: "decoder.0.weight", "decoder.0.bias", "decoder.2.weight", "decoder.2.bias", "decoder.4.weight", "decoder.4.bias". 
	Unexpected key(s) in state_dict: "w_expert0", "b_expert0", "w_expert1", "b_expert1", "w_expert2", "b_expert2", "gate.0.weight", "gate.0.bias", "gate.2.weight", "gate.2.bias", "gate.4.weight", "gate.4.bias", "gate.6.weight", "gate.6.bias". 
	size mismatch for encoder.2.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([128, 256]).
	size mismatch for encoder.2.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for encoder.4.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for encoder.4.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for mu.weight: copying a param with shape torch.Size([32, 256]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for log_var.weight: copying a param with shape torch.Size([32, 256]) from checkpoint, the shape in current model is torch.Size([32, 64]).
[2023-05-25 16:51:08,649][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-51-08
[2023-05-25 16:51:19,605][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 93, in infer
    poses = poses.to("cuda")
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module.py", line 109, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument tensors in method wrapper_CUDA_cat)
[2023-05-25 16:51:19,609][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-40-34
[2023-05-25 16:52:40,719][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:52:40,736][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:52:40,911][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:52:40,938][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:52:41,637][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:52:41,744][__main__][INFO] - Starting inference!
[2023-05-25 16:53:15,837][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 79, in infer
    poses = base_pose.copy().unsqueeze(0)
AttributeError: 'Tensor' object has no attribute 'copy'
[2023-05-25 16:53:15,841][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-52-40
[2023-05-25 16:53:40,736][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:53:40,752][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:53:40,934][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:53:40,960][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:53:41,722][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:53:41,832][__main__][INFO] - Starting inference!
[2023-05-25 16:53:53,637][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 92, in infer
    poses = base_pose.copy().unsqueeze(0)
AttributeError: 'Tensor' object has no attribute 'copy'
[2023-05-25 16:53:53,642][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-53-40
[2023-05-25 16:54:14,568][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:54:14,584][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:54:14,761][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:54:14,787][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:54:15,492][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:54:15,598][__main__][INFO] - Starting inference!
[2023-05-25 16:54:50,328][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 96, in infer
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module.py", line 109, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
RuntimeError: Tensors must have same number of dimensions: got 2 and 1
[2023-05-25 16:54:50,335][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-54-14
[2023-05-25 16:55:41,652][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 16:55:41,668][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 16:55:41,842][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 16:55:41,869][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 16:55:42,564][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 16:55:42,668][__main__][INFO] - Starting inference!
[2023-05-25 16:56:28,743][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_16-55-41
[2023-05-25 17:01:30,752][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 17:01:30,768][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 17:01:30,927][__main__][INFO] - Instantiating datamodule <src.data.lafan_pose_datamodule.LAFANDataModule>
[2023-05-25 17:01:30,937][__main__][INFO] - Instantiating model <src.models.beta_vae_module.beta_VAEModule>
[2023-05-25 17:01:30,985][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/random_walk_mvae.py", line 55, in infer
    model: LightningModule = hydra.utils.get_class(cfg.model._target_).load_from_checkpoint(checkpoint_path = cfg.ckpt_path)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/module.py", line 1531, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 90, in _load_from_checkpoint
    return _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 149, in _load_state
    keys = obj.load_state_dict(checkpoint["state_dict"], strict=strict)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 2041, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for beta_VAEModule:
	Missing key(s) in state_dict: "decoder.0.weight", "decoder.0.bias", "decoder.2.weight", "decoder.2.bias", "decoder.4.weight", "decoder.4.bias". 
	Unexpected key(s) in state_dict: "w_expert0", "b_expert0", "w_expert1", "b_expert1", "w_expert2", "b_expert2", "gate.0.weight", "gate.0.bias", "gate.2.weight", "gate.2.bias", "gate.4.weight", "gate.4.bias", "gate.6.weight", "gate.6.bias". 
	size mismatch for encoder.2.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([128, 256]).
	size mismatch for encoder.2.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for encoder.4.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for encoder.4.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for mu.weight: copying a param with shape torch.Size([32, 256]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for log_var.weight: copying a param with shape torch.Size([32, 256]) from checkpoint, the shape in current model is torch.Size([32, 64]).
[2023-05-25 17:01:30,989][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_17-01-30
[2023-05-25 17:06:01,632][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 17:06:01,648][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 17:06:01,828][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 17:06:01,854][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 17:06:02,544][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 17:06:02,650][__main__][INFO] - Starting inference!
[2023-05-25 17:06:59,269][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 17:06:59,285][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 17:06:59,461][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 17:06:59,487][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 17:07:00,172][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 17:07:00,280][__main__][INFO] - Starting inference!
[2023-05-25 17:08:59,845][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 17:08:59,862][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 17:09:00,039][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 17:09:00,083][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 17:09:01,025][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 17:09:01,133][__main__][INFO] - Starting inference!
[2023-05-25 17:11:30,779][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_17-08-59
[2023-05-25 17:35:54,837][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 17:35:54,852][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 17:35:55,004][__main__][INFO] - Instantiating datamodule <src.data.lafan_pose_datamodule.LAFANDataModule>
[2023-05-25 17:35:55,019][__main__][INFO] - Instantiating model <src.models.beta_vae_module.beta_VAEModule>
[2023-05-25 17:35:55,068][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/random_walk_mvae.py", line 55, in infer
    model: LightningModule = hydra.utils.get_class(cfg.model._target_).load_from_checkpoint(checkpoint_path = cfg.ckpt_path)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/module.py", line 1531, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 90, in _load_from_checkpoint
    return _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 149, in _load_state
    keys = obj.load_state_dict(checkpoint["state_dict"], strict=strict)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 2041, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for beta_VAEModule:
	Missing key(s) in state_dict: "decoder.0.weight", "decoder.0.bias", "decoder.2.weight", "decoder.2.bias", "decoder.4.weight", "decoder.4.bias". 
	Unexpected key(s) in state_dict: "w_expert0", "b_expert0", "w_expert1", "b_expert1", "w_expert2", "b_expert2", "gate.0.weight", "gate.0.bias", "gate.2.weight", "gate.2.bias", "gate.4.weight", "gate.4.bias", "gate.6.weight", "gate.6.bias". 
	size mismatch for encoder.2.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([128, 256]).
	size mismatch for encoder.2.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for encoder.4.weight: copying a param with shape torch.Size([256, 256]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for encoder.4.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for mu.weight: copying a param with shape torch.Size([32, 256]) from checkpoint, the shape in current model is torch.Size([32, 64]).
	size mismatch for log_var.weight: copying a param with shape torch.Size([32, 256]) from checkpoint, the shape in current model is torch.Size([32, 64]).
[2023-05-25 17:35:55,072][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_17-35-54
[2023-05-25 17:36:00,746][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 17:36:00,763][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 17:36:00,943][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 17:36:00,976][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 17:36:01,762][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 17:36:01,876][__main__][INFO] - Starting inference!
[2023-05-25 17:36:56,199][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-25 17:36:56,222][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-25 17:36:56,403][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-05-25 17:36:56,454][__main__][INFO] - Instantiating model <src.models.mvae_module.MVAEModule>
[2023-05-25 17:36:57,483][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-05-25 17:36:57,600][__main__][INFO] - Starting inference!
[2023-05-25 17:37:30,640][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-05-25_17-36-55
[2023-06-01 10:37:32,699][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-01 10:37:32,715][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-01 10:37:32,886][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-06-01 10:37:32,912][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-01 10:37:32,969][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 55, in infer
    model: LightningModule = hydra.utils.get_class(cfg.model._target_).load_from_checkpoint(checkpoint_path = cfg.ckpt_path)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/module.py", line 1531, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 90, in _load_from_checkpoint
    return _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/lightning/pytorch/core/saving.py", line 136, in _load_state
    obj = cls(**_cls_kwargs)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_scheduled_sampling.py", line 64, in __init__
    nn.Parameter(torch.empty(self.n_experts, self.n_features + self.latent_dim, self.hidden_size, device="cuda")),
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/cuda/__init__.py", line 247, in _lazy_init
    torch._C._cuda_init()
RuntimeError: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero.
[2023-06-01 10:37:32,972][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-01_10-37-32
[2023-06-01 10:44:45,680][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-01 10:44:45,703][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-01 10:44:45,877][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-06-01 10:44:45,931][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-01 10:44:47,003][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-01 10:44:47,111][__main__][INFO] - Starting inference!
[2023-06-01 10:45:52,311][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-01 10:45:52,327][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-01 10:45:52,501][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-06-01 10:45:52,528][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-01 10:45:53,217][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-01 10:45:53,322][__main__][INFO] - Starting inference!
[2023-06-01 10:48:17,782][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-01_10-44-45
[2023-06-01 10:48:19,898][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-01_10-45-52
[2023-06-02 10:33:29,421][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-02 10:33:29,447][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-02 10:33:29,631][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_datamodule.LAFANDataModule>
[2023-06-02 10:33:29,673][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-02 10:33:30,708][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-02 10:33:30,816][__main__][INFO] - Starting inference!
[2023-06-02 10:33:54,208][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-02_10-33-29
[2023-06-02 17:16:13,649][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-02 17:16:13,665][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-02 17:16:13,838][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule.LAFANDataModule>
[2023-06-02 17:16:13,866][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-02 17:16:14,609][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-02 17:16:14,715][__main__][INFO] - Starting inference!
[2023-06-02 17:16:31,499][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-02_17-16-13
[2023-06-02 19:19:26,571][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-02 19:19:26,587][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-02 19:19:26,793][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule.LAFANDataModule>
[2023-06-02 19:19:26,821][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-02 19:19:27,634][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-02 19:19:27,744][__main__][INFO] - Starting inference!
[2023-06-02 19:19:59,795][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-02 19:19:59,811][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-02 19:19:59,994][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule.LAFANDataModule>
[2023-06-02 19:20:00,024][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-02 19:20:00,810][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-02 19:20:00,917][__main__][INFO] - Starting inference!
[2023-06-02 19:20:18,922][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-02_19-19-59
[2023-06-02 19:26:09,753][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-02 19:26:09,769][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-02 19:26:09,948][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule.LAFANDataModule>
[2023-06-02 19:26:09,977][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-02 19:26:10,764][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-02 19:26:10,871][__main__][INFO] - Starting inference!
[2023-06-02 19:26:28,209][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-02_19-26-09
[2023-06-06 17:13:10,199][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:13:10,215][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:13:10,384][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:13:10,421][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:13:11,325][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:13:11,427][__main__][INFO] - Starting inference!
[2023-06-06 17:13:14,728][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(y=poses)
TypeError: model_output_to_pose() missing 1 required positional argument: 'self'
[2023-06-06 17:13:14,731][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-13-09
[2023-06-06 17:30:23,874][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:30:23,890][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:30:24,065][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:30:24,092][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:30:24,865][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:30:24,973][__main__][INFO] - Starting inference!
[2023-06-06 17:30:28,005][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(datamodule.train_dataloader().dataset, y=poses)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 177, in model_output_to_pose
    y = y.denormalize(y, self.data_mean, self.data_std)
AttributeError: 'Tensor' object has no attribute 'denormalize'
[2023-06-06 17:30:28,008][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-30-23
[2023-06-06 17:31:44,478][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:31:44,494][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:31:44,671][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:31:44,698][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:31:45,455][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:31:45,561][__main__][INFO] - Starting inference!
[2023-06-06 17:31:48,506][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(datamodule.train_dataloader().dataset, y=poses)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 177, in model_output_to_pose
    y = self.denormalize(y, self.data_mean, self.data_std)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 64, in denormalize
    denormalized_data = torch.where(std != 0, data*std + mean, data + mean)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2023-06-06 17:31:48,509][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-31-44
[2023-06-06 17:33:41,257][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:33:41,280][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:33:41,461][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:33:41,488][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:33:42,240][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:33:42,343][__main__][INFO] - Starting inference!
[2023-06-06 17:33:45,401][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(datamodule.train_dataloader().dataset, y=poses)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 177, in model_output_to_pose
    y = self.denormalize(y, self.data_mean, self.data_std)
TypeError: denormalize() takes 2 positional arguments but 4 were given
[2023-06-06 17:33:45,404][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-33-41
[2023-06-06 17:34:36,532][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:34:36,547][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:34:36,717][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:34:36,743][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:34:37,500][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:34:37,606][__main__][INFO] - Starting inference!
[2023-06-06 17:34:40,788][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(datamodule.train_dataloader().dataset, y=poses)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 177, in model_output_to_pose
    y = self.denormalize(y)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 64, in denormalize
    denormalized_data = torch.where(self.std != 0, data*self.std + self.mean, self.data + self.mean)
AttributeError: 'PoseSequenceDataset' object has no attribute 'std'
[2023-06-06 17:34:40,791][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-34-36
[2023-06-06 17:35:55,361][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:35:55,376][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:35:55,551][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:35:55,579][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:35:56,288][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:35:56,393][__main__][INFO] - Starting inference!
[2023-06-06 17:35:59,476][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(datamodule.train_dataloader().dataset, y=poses)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 177, in model_output_to_pose
    y = self.denormalize(y)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 64, in denormalize
    denormalized_data = torch.where(self.data_std != 0, data*self.data_std + self.data_mean, data + self.data_mean)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2023-06-06 17:35:59,479][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-35-55
[2023-06-06 17:37:30,403][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:37:30,418][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:37:30,588][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:37:30,614][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:37:31,328][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:37:31,432][__main__][INFO] - Starting inference!
[2023-06-06 17:37:34,501][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(datamodule.train_dataloader().dataset.to("cuda"), y=poses)
AttributeError: 'PoseSequenceDataset' object has no attribute 'to'
[2023-06-06 17:37:34,504][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-37-30
[2023-06-06 17:39:58,560][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:39:58,575][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:39:58,747][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:39:58,774][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:39:59,509][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:39:59,612][__main__][INFO] - Starting inference!
[2023-06-06 17:40:02,613][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(datamodule.train_dataloader().dataset, y=poses)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 178, in model_output_to_pose
    y = self.denormalize(y)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 65, in denormalize
    denormalized_data = torch.where(self.data_std != 0, data*self.data_std + self.data_mean, data + self.data_mean)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2023-06-06 17:40:02,616][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-39-58
[2023-06-06 17:40:36,709][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:40:36,725][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:40:36,897][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:40:36,927][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:40:37,699][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:40:37,807][__main__][INFO] - Starting inference!
[2023-06-06 17:40:40,831][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(datamodule.train_dataloader().dataset, y=poses)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 179, in model_output_to_pose
    y = self.denormalize(y)
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/data/lafan_mvae_locomotion_datamodule_normalize.py", line 66, in denormalize
    denormalized_data = torch.where(self.data_std != 0, data*self.data_std + self.data_mean, data + self.data_mean)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2023-06-06 17:40:40,834][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-40-36
[2023-06-06 17:41:13,682][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-06 17:41:13,698][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-06 17:41:13,867][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-06 17:41:13,894][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-06 17:41:14,654][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-06 17:41:14,757][__main__][INFO] - Starting inference!
[2023-06-06 17:42:39,376][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-06_17-41-13
[2023-06-07 10:49:26,514][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-07 10:49:26,538][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-07 10:49:26,712][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_normalize.LAFANDataModule>
[2023-06-07 10:49:26,737][__main__][INFO] - Instantiating model <src.models.mvae_module_scheduled_sampling.MVAEModule>
[2023-06-07 10:49:27,437][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-07 10:49:27,549][__main__][INFO] - Starting inference!
[2023-06-07 10:49:44,296][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-07_10-49-26
[2023-06-09 22:20:35,163][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-09 22:20:35,179][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-09 22:20:35,357][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-09 22:20:35,385][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_corrected.MVAEModule>
[2023-06-09 22:20:36,156][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-09 22:20:36,275][__main__][INFO] - Starting inference!
[2023-06-09 22:20:39,178][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 100, in infer
    anim = datamodule.train_dataloader().dataset.model_output_to_pose(datamodule.train_dataloader().dataset, y=poses)
TypeError: model_output_to_pose() got multiple values for argument 'y'
[2023-06-09 22:20:39,181][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-09_22-20-34
[2023-06-09 22:21:46,804][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-09 22:21:46,821][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-09 22:21:46,994][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-09 22:21:47,021][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_corrected.MVAEModule>
[2023-06-09 22:21:47,810][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-09 22:21:47,919][__main__][INFO] - Starting inference!
[2023-06-09 22:22:10,863][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-09_22-21-46
[2023-06-09 22:27:29,230][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-09 22:27:29,246][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-09 22:27:29,420][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-09 22:27:29,446][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_corrected.MVAEModule>
[2023-06-09 22:27:30,171][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-09 22:27:30,281][__main__][INFO] - Starting inference!
[2023-06-09 22:27:48,127][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-09_22-27-29
[2023-06-12 17:04:37,620][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-12 17:04:37,636][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-12 17:04:37,807][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-12 17:04:37,860][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_corrected.MVAEModule>
[2023-06-12 17:04:38,918][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-12 17:04:39,035][__main__][INFO] - Starting inference!
[2023-06-12 17:04:56,117][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-12_17-04-37
[2023-06-13 10:30:26,058][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-13 10:30:26,075][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-13 10:30:26,250][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-13 10:30:26,285][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-13 10:30:27,013][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-13 10:30:27,127][__main__][INFO] - Starting inference!
[2023-06-13 10:30:44,266][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-13_10-30-25
[2023-06-13 10:33:08,194][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-13 10:33:08,211][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-13 10:33:08,389][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-13 10:33:08,414][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-13 10:33:09,164][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-13 10:33:09,275][__main__][INFO] - Starting inference!
[2023-06-13 10:33:27,302][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-13_10-33-07
[2023-06-13 10:38:36,814][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-13 10:38:36,831][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-13 10:38:37,008][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-13 10:38:37,033][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-13 10:38:37,734][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-13 10:38:37,840][__main__][INFO] - Starting inference!
[2023-06-13 10:38:54,577][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-13_10-38-36
[2023-06-13 10:41:18,190][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-13 10:41:18,207][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-13 10:41:18,384][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-13 10:41:18,411][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-13 10:41:19,125][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-13 10:41:19,235][__main__][INFO] - Starting inference!
[2023-06-13 10:41:36,235][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-13_10-41-17
[2023-06-13 10:43:24,158][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-13 10:43:24,175][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-13 10:43:24,354][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-13 10:43:24,380][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-13 10:43:25,076][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-13 10:43:25,184][__main__][INFO] - Starting inference!
[2023-06-13 10:43:42,010][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-13_10-43-23
[2023-06-13 10:43:55,370][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-13 10:43:55,387][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-13 10:43:55,563][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-13 10:43:55,589][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-13 10:43:56,287][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-13 10:43:56,395][__main__][INFO] - Starting inference!
[2023-06-13 10:44:13,473][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-13_10-43-55
[2023-06-14 17:26:21,787][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-14 17:26:21,805][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-14 17:26:22,006][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-14 17:26:22,044][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_moe_bis.MVAEModule>
[2023-06-14 17:26:22,128][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-14 17:26:22,255][__main__][INFO] - Starting inference!
[2023-06-14 17:26:25,826][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 98, in infer
    poses = torch.cat([poses, model.decode(z, previous_pose)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_moe_bis.py", line 107, in decode
    mean_predpose = sum([self.coefficients[:, i].view(-1, 1)*expert_pred[i] for i in range(self.n_experts)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_moe_bis.py", line 107, in <listcomp>
    mean_predpose = sum([self.coefficients[:, i].view(-1, 1)*expert_pred[i] for i in range(self.n_experts)])
TypeError: 'NoneType' object is not subscriptable
[2023-06-14 17:26:25,829][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-14_17-26-21
[2023-06-14 17:28:31,643][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-14 17:28:31,660][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-14 17:28:31,850][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-14 17:28:31,879][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_moe_bis.MVAEModule>
[2023-06-14 17:28:31,963][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-14 17:28:32,083][__main__][INFO] - Starting inference!
[2023-06-14 17:28:35,537][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 98, in infer
    poses = torch.cat([poses, model.decode(z, previous_pose)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_moe_bis.py", line 107, in decode
    self.coefficients = self.gate(torch.cat((prevpose, z), dim=1))
NameError: name 'prevpose' is not defined
[2023-06-14 17:28:35,540][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-14_17-28-31
[2023-06-14 17:28:51,757][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-14 17:28:51,775][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-14 17:28:51,964][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-14 17:28:51,993][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_moe_bis.MVAEModule>
[2023-06-14 17:28:52,081][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-14 17:28:52,203][__main__][INFO] - Starting inference!
[2023-06-14 17:29:39,849][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-14_17-28-51
[2023-06-14 17:39:27,316][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-14 17:39:27,334][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-14 17:39:27,529][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-14 17:39:27,559][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_moe_bis.MVAEModule>
[2023-06-14 17:39:27,645][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-14 17:39:27,767][__main__][INFO] - Starting inference!
[2023-06-14 17:39:55,576][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-14 17:39:55,594][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-14 17:39:55,784][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-14 17:39:55,811][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_moe_bis.MVAEModule>
[2023-06-14 17:39:55,896][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-14 17:39:56,016][__main__][INFO] - Starting inference!
[2023-06-14 17:40:43,975][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-14_17-39-55
[2023-06-15 11:37:10,117][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-15 11:37:10,134][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-15 11:37:10,323][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_locomotion_datamodule_corrected.LAFANDataModule>
[2023-06-15 11:37:10,362][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_moe_bis.MVAEModule>
[2023-06-15 11:37:10,459][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-15 11:37:10,581][__main__][INFO] - Starting inference!
[2023-06-15 11:37:14,169][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 98, in infer
    poses = torch.cat([poses, model.decode(z, previous_pose)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_moe_bis.py", line 107, in decode
    mean_predpose = sum([self.coefficients[:, i].view(-1, 1)*expert_pred[i] for i in range(self.n_experts)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_moe_bis.py", line 107, in <listcomp>
    mean_predpose = sum([self.coefficients[:, i].view(-1, 1)*expert_pred[i] for i in range(self.n_experts)])
TypeError: 'NoneType' object is not subscriptable
[2023-06-15 11:37:14,172][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-15_11-37-09
[2023-06-28 15:14:16,398][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-28 15:14:16,415][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-28 15:14:16,586][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_root_space_sgskeleton.LAFANDataModule>
[2023-06-28 15:14:16,615][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-28 15:14:17,676][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-28 15:14:17,797][__main__][INFO] - Starting inference!
[2023-06-28 15:14:40,434][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 98, in infer
    poses = torch.cat([poses, model.decode(z, previous_pose)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_dec_lr.py", line 114, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x327 and 288x256)
[2023-06-28 15:14:40,438][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-28_15-14-16
[2023-06-28 15:21:30,734][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-28 15:21:30,750][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-28 15:21:30,915][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_root_space_sgskeleton.LAFANDataModule>
[2023-06-28 15:21:30,944][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-28 15:21:31,658][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-28 15:21:31,769][__main__][INFO] - Starting inference!
[2023-06-28 15:21:51,132][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 98, in infer
    poses = torch.cat([poses, model.decode(z, previous_pose)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_dec_lr.py", line 114, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x327 and 288x256)
[2023-06-28 15:21:51,136][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-28_15-21-30
[2023-06-28 15:26:45,975][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-28 15:26:45,992][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-28 15:26:46,153][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_root_space_sgskeleton.LAFANDataModule>
[2023-06-28 15:26:46,181][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-28 15:26:46,889][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-28 15:26:46,999][__main__][INFO] - Starting inference!
[2023-06-28 15:27:01,538][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 98, in infer
    poses = torch.cat([poses, model.decode(z, previous_pose)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_dec_lr.py", line 114, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x327 and 288x256)
[2023-06-28 15:27:01,541][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-28_15-26-45
[2023-06-28 15:27:39,504][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-28 15:27:39,520][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-28 15:27:39,681][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_root_space_sgskeleton.LAFANDataModule>
[2023-06-28 15:27:39,709][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-28 15:27:40,422][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-28 15:27:40,531][__main__][INFO] - Starting inference!
[2023-06-28 15:27:46,061][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 98, in infer
    poses = torch.cat([poses, model.decode(z, previous_pose)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_dec_lr.py", line 114, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x327 and 288x256)
[2023-06-28 15:27:46,064][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-28_15-27-39
[2023-06-28 15:31:42,648][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-28 15:31:42,665][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-28 15:31:42,836][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_root_space_sgskeleton.LAFANDataModule>
[2023-06-28 15:31:42,864][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-28 15:31:43,584][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-28 15:31:43,693][__main__][INFO] - Starting inference!
[2023-06-28 15:31:53,512][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 98, in infer
    poses = torch.cat([poses, model.decode(z, previous_pose)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_dec_lr.py", line 114, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x323 and 288x256)
[2023-06-28 15:31:53,517][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-28_15-31-42
[2023-06-28 15:32:57,949][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-28 15:32:57,966][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-28 15:32:58,112][__main__][INFO] - Instantiating datamodule <src.data.lafan_mvae_root_space_sgskeleton.LAFANDataModule>
[2023-06-28 15:32:58,138][__main__][INFO] - Instantiating model <src.models.mvae_module_ss_dec_lr.MVAEModule>
[2023-06-28 15:32:58,889][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2023-06-28 15:32:59,003][__main__][INFO] - Starting inference!
[2023-06-28 15:34:15,137][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/random_walk_mvae.py", line 98, in infer
    poses = torch.cat([poses, model.decode(z, previous_pose)])
  File "/home/kinetix/Documents/Hydra/lightning-hydra-template/src/models/mvae_module_ss_dec_lr.py", line 114, in decode
    coefficients = self.gate(torch.cat((c, z), dim=1))
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kinetix/anaconda3/envs/hydra_env/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x323 and 288x256)
[2023-06-28 15:34:15,140][src.utils.utils][INFO] - Output dir: /home/kinetix/Documents/Hydra/lightning-hydra-template/logs/infer/runs/2023-06-28_15-32-57
